close all
clear

addpath('../Check/');

baseDir = '/data/cees/ceyoon/FASTcode/data/OutputFAST/';
fileName = 'detdata_wLen6_wLag0.05_fpLen64_fpLag10_tvalue400_nfuncs5_ntbls100_nvotes4.mat';

folderStr = {...
    'HRSN_GHIB_BP1_20060509_24hr', ...
    'HRSN_EADB_BP1_20060509_24hr', 'HRSN_EADB_BP2_20060509_24hr', 'HRSN_EADB_BP3_20060509_24hr', ...
    'HRSN_JCNB_BP1_20060509_24hr', 'HRSN_JCNB_BP2_20060509_24hr', 'HRSN_JCNB_BP3_20060509_24hr', ...
    'HRSN_FROB_BP1_20060509_24hr', 'HRSN_FROB_BP2_20060509_24hr', 'HRSN_FROB_BP3_20060509_24hr', ...
    'HRSN_VCAB_BP1_20060509_24hr', 'HRSN_VCAB_BP2_20060509_24hr', 'HRSN_VCAB_BP3_20060509_24hr', ...
    'HRSN_MMNB_BP1_20060509_24hr', 'HRSN_MMNB_BP2_20060509_24hr', 'HRSN_MMNB_BP3_20060509_24hr', ...
    'HRSN_LCCB_BP1_20060509_24hr', 'HRSN_LCCB_BP2_20060509_24hr', 'HRSN_LCCB_BP3_20060509_24hr', ...
    'HRSN_RMNB_BP1_20060509_24hr', 'HRSN_RMNB_BP2_20060509_24hr', 'HRSN_RMNB_BP3_20060509_24hr', ...
    'HRSN_CCRB_BP1_20060509_24hr', 'HRSN_CCRB_BP2_20060509_24hr', 'HRSN_CCRB_BP3_20060509_24hr', ...
    'HRSN_SMNB_BP1_20060509_24hr', 'HRSN_SMNB_BP2_20060509_24hr', 'HRSN_SMNB_BP3_20060509_24hr', ...
    'HRSN_SCYB_BP1_20060509_24hr', 'HRSN_SCYB_BP2_20060509_24hr', 'HRSN_SCYB_BP3_20060509_24hr', ...
    'HRSN_VARB_BP1_20060509_24hr', 'HRSN_VARB_BP2_20060509_24hr', 'HRSN_VARB_BP3_20060509_24hr', ...
    };
out_dir = '../../../figures/HRSN/outputs/HRSN_detections_20060509_24hr/';
catalogFile = '../../../data/TimeSeries/HRSN/cat20060509.txt';

% folderStr = {...
%    'HRSN_GHIB_BP1_20071026_24hr', 'HRSN_GHIB_BP2_20071026_24hr', 'HRSN_GHIB_BP3_20071026_24hr', ...
%    'HRSN_EADB_BP1_20071026_24hr', 'HRSN_EADB_BP2_20071026_24hr', 'HRSN_EADB_BP3_20071026_24hr', ...
%    'HRSN_JCNB_BP1_20071026_24hr', 'HRSN_JCNB_BP2_20071026_24hr', 'HRSN_JCNB_BP3_20071026_24hr', ...
%    'HRSN_FROB_BP1_20071026_24hr', 'HRSN_FROB_BP2_20071026_24hr', 'HRSN_FROB_BP3_20071026_24hr', ...
%    'HRSN_VCAB_BP1_20071026_24hr', 'HRSN_VCAB_BP2_20071026_24hr', 'HRSN_VCAB_BP3_20071026_24hr', ...
%    'HRSN_MMNB_BP1_20071026_24hr', 'HRSN_MMNB_BP2_20071026_24hr', 'HRSN_MMNB_BP3_20071026_24hr', ...
%    'HRSN_LCCB_BP1_20071026_24hr', 'HRSN_LCCB_BP2_20071026_24hr', 'HRSN_LCCB_BP3_20071026_24hr', ...
%    'HRSN_RMNB_BP1_20071026_24hr', 'HRSN_RMNB_BP2_20071026_24hr', 'HRSN_RMNB_BP3_20071026_24hr', ...
%    'HRSN_CCRB_BP1_20071026_24hr', 'HRSN_CCRB_BP2_20071026_24hr', 'HRSN_CCRB_BP3_20071026_24hr', ...
%    'HRSN_SMNB_BP1_20071026_24hr', 'HRSN_SMNB_BP2_20071026_24hr', 'HRSN_SMNB_BP3_20071026_24hr', ...
%    'HRSN_SCYB_BP1_20071026_24hr', 'HRSN_SCYB_BP2_20071026_24hr', 'HRSN_SCYB_BP3_20071026_24hr', ...
%    'HRSN_JCSB_BP1_20071026_24hr', 'HRSN_JCSB_BP2_20071026_24hr', 'HRSN_JCSB_BP3_20071026_24hr', ...
%    'HRSN_VARB_BP1_20071026_24hr', 'HRSN_VARB_BP2_20071026_24hr', 'HRSN_VARB_BP3_20071026_24hr', ...
%    };
% out_dir = '../../../figures/HRSN/outputs/HRSN_detections_20071026_24hr/';
% catalogFile = '../../../data/TimeSeries/HRSN/cat20071026.txt';

% Read in catalog file
fid = fopen(catalogFile, 'r');
catData = textscan(fid, '%s %s %s %s %s %s %s %s %*[^\n]');
fclose(fid);
catTimes = str2double(catData{4});
catValues = 2*ones(size(catTimes));

plot_thresh = 0.05;
for ifile=1:length(folderStr)
    inputFile = strcat(baseDir, folderStr{ifile}, '/', fileName);
    load(inputFile);

    list = find(detdata.pair_k > plot_thresh);
    stem(catTimes, catValues, 'm');
    hold on
    plot_detection_indices(detdata.pair_i(list), detdata.pair_j(list), detdata.pair_k(list), dt_fp, ...
        folderStr{ifile}, 'Fraction of tables found');
    hold off

    outfile = [out_dir 'single_channel_' folderStr{ifile} '_fast_detections.png'];
    print('-dpng', outfile);
end
